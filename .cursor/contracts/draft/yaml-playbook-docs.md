# Contract — yaml-playbook-docs

**Status:** draft  
**Goal:** Extend the autodoc-generated documentation skeleton with Asterisk-specific narrative, the Ansible analogy, and project identity to produce a complete, visitor-ready docs tree.  
**Serves:** 100% DSL — Zero Go; onboarding; external visibility

## Contract rules

- README must position Asterisk as a YAML playbook (the "Ansible for RCA" pitch), not a Go project.
- No broken links — every reference must resolve to an existing file.
- Architecture diagrams must match the current repo structure (zero Go, circuits/, scorecards/, origami.yaml).
- Build on the `origami autodoc --scaffold` output — do not duplicate what autodoc generates. Fill in stubs, enrich narrative, add project-specific content.

## Context

Asterisk achieved 100% YAML — zero `.go` files. But `README.md` still says `go build -o bin/asterisk ./cmd/asterisk/` and `CONTRIBUTING.md` lists `cmd/`, `internal/`, `adapters/` as the project structure. A visitor to the repo would be thoroughly confused.

The Ansible analogy is the guiding metaphor: there is no Python in an Ansible repo — only YAML playbooks. The Python lives in Ansible (the engine) and in collections (the plugins). Asterisk follows the same model.

### Dependencies

- **`origami-autodoc`** — generates the deterministic docs skeleton (tree structure, circuit pages, CLI reference, scorecard reference). This contract extends that skeleton with narrative.
- **`housekeeping`** — stale refs should be cleaned first so docs don't reference things that are about to be removed.

### Two documentation targets

- **`docs/`** (new, at repo root) — user-facing documentation tree. Generated by `origami autodoc`, enriched by this contract. This is what GitHub renders, what visitors read.
- **`.cursor/docs/`** (existing) — agent-facing knowledge store. Internal schemas, models, journals, postmortems. Not for external consumption. Stays as-is.

## FSC artifacts

| Artifact | Target | Compartment |
|----------|--------|-------------|
| Architecture diagram (Mermaid) | `docs/concepts/architecture.md` | domain |

## Execution strategy

### Phase 1: Generate the skeleton

- Run `origami autodoc --scaffold` in Asterisk to produce the `docs/` tree.
- Review the generated output: README.md, per-circuit pages, CLI reference, stubs.
- This phase produces no hand-written content — it validates autodoc output is correct and complete.

### Phase 2: README.md enrichment

Starting from the autodoc-generated README.md, enrich with:
- The "Ansible for RCA" pitch — position Asterisk as a YAML playbook, not a Go project.
- PoC results summary: BasicAdapter M19=0.83, CursorAdapter M19=0.58, 50,000x ROI.
- Framework overview: Origami engine, Elements, Personas, Adversarial Dialectic (brief, link to Origami docs).
- Analyze example with `examples/pre-investigation-33195-4.21/`.
- Calibration example.
- Cursor skill reference (link to `.cursor/skills/`).
- Index into the `docs/` tree — ensure every page is linked.

### Phase 3: Concept pages

Fill in the stubs generated by autodoc in `docs/concepts/`:
- `architecture.md` — the Ansible model: playbook repo (Asterisk) vs engine repo (Origami) vs module repo (Origami `modules/rca/`). Mermaid diagram of the relationship. Reference the end-state architecture from `current-goal.mdc`.
- `pipeline-stages.md` — F0-F6 pipeline stages explained with examples.
- `calibration.md` — stub/dry/wet taxonomy, scorecards, metrics overview. Link to `docs/reference/metrics.md`.

### Phase 4: Contributing pages

Fill in the stubs in `docs/contributing/`:
- `development.md` — how to modify circuits, run `origami lint`, run calibration via Cursor skill.
- `conventions.md` — conventional commits, Red-Orange-Green-Yellow-Blue cycle, contract workflow. Content migrated from current `CONTRIBUTING.md`.

### Phase 5: Retire old docs

- `CONTRIBUTING.md` at repo root becomes a thin redirect to `docs/contributing/`.
- Remove broken links to `docs/framework-guide.md` and `README.md.post`.
- Audit `.cursor/docs/` — flag entries that are stale (reference `cmd/`, `internal/`, `adapters/`). Update or mark as historical.

## Coverage matrix

| Layer | Applies | Rationale |
|-------|---------|-----------|
| **Unit** | no | Documentation only |
| **Integration** | no | No code changes |
| **Contract** | no | No API changes |
| **E2E** | no | No behavior changes |
| **Concurrency** | no | N/A |
| **Security** | no | No trust boundaries |

## Tasks

- [ ] Phase 1 — Run `origami autodoc --scaffold`, review and validate output
- [ ] Phase 2 — Enrich README.md with Asterisk identity, PoC results, examples, docs index
- [ ] Phase 3 — Fill concept page stubs (architecture, pipeline-stages, calibration)
- [ ] Phase 4 — Fill contributing page stubs (development, conventions)
- [ ] Phase 5 — Retire old docs: thin-redirect CONTRIBUTING.md, remove broken links, audit `.cursor/docs/`
- [ ] Validate — all links resolve, no broken references, tree structure complete
- [ ] Tune (blue) — polish language, ensure Ansible analogy is consistent throughout
- [ ] Validate (green) — final review for broken links

## Acceptance criteria

- **Given** `origami autodoc --scaffold` was run, **when** reading the `docs/` tree, **then** every stub page has been filled with Asterisk-specific content.
- **Given** a new developer visiting the repo, **when** reading README.md, **then** they understand Asterisk is YAML-only, know how to build (`just build`), and can run their first analysis.
- **Given** README.md, **when** checking all links, **then** zero broken links — every `docs/` page is reachable from README.
- **Given** `docs/concepts/architecture.md`, **when** viewing the Mermaid diagram, **then** it shows Asterisk as YAML-only with Origami as the Go engine.
- **Given** `docs/contributing/`, **when** reading the development guide, **then** it matches the actual workflow (circuits, `origami lint`, calibration via Cursor skill).
- **Given** a search for `make build` or `go build` in README.md or any `docs/` page, **then** zero matches.
- **Given** `CONTRIBUTING.md` at repo root, **when** reading it, **then** it redirects to `docs/contributing/`.

## Security assessment

No trust boundaries affected. Documentation only.

## Notes

2026-03-02 00:00 — Contract drafted. The repo's public face must match its reality: Asterisk is a YAML playbook, not a Go project.

2026-03-02 01:00 — Contract restructured. Now depends on `origami-autodoc` for the generated skeleton. Phases reworked: generate skeleton first, then enrich with narrative. Docs tree moves to `docs/` at repo root (Kubernetes pattern). `.cursor/docs/` remains as agent-facing knowledge store.
