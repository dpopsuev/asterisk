# .cursor/contracts Index

Work contracts -- session-independent execution plans with state, tasks, and completion criteria.

**Organization:** Directories reflect lifecycle status (`draft/`, `active/`, `completed/`). Urgency relative to the current goal is defined in `current-goal.mdc`. Read the goal manifest first to know what matters now.

---

## active/ -- Contracts being executed

| Contract | Goal | Serves |
|----------|------|--------|
| `rp-e2e-launch.md` | Real blind E2E run: fetch 4 RP-linked launches, analyze with BasicAdapter, score against Jira-verified ground truth, push at least 1 result back to RP. **Final PoC gate.** | PoC completion |

## draft/ -- Planned, not yet being executed

| Contract | Goal | Serves |
|----------|------|--------|
| `poc-tuning-loop.md` | Improve BasicAdapter accuracy on blind cases via targeted prompt/pipeline improvements. Activates after rp-e2e-launch. | PoC completion |
| `evidence-gap-brief.md` | Structured "what's missing" output when pipeline confidence is low or inconclusive. Shared `EvidenceGap` type with Defect Court mistrial. | PoC completion |
| `poc-scope-precision.md` | Zero-friction PoC packaging: simplified CLI (`analyze <ID>`), `/asterisk-analyze` Cursor skill, CEO-ready README. | PoC completion |
| `mcp-server-foundation.md` | `asterisk serve` starts a stateful MCP server over stdio; placeholder tools. | MCP integration |
| `mcp-pipeline-tools.md` | MCP tools driving F0-F6 pipeline. Depends on mcp-server-foundation. | MCP integration |
| `mcp-calibration-mode.md` | Calibration-specific MCP tools. Depends on mcp-pipeline-tools. | MCP integration |
| `origami-ground-truth-ingestor.md` | Agentic dataset curation: AI subagents consume unstructured evidence into structured ground truth. JSON files (reviewability-first), CLI-first, MCP bridge. | Dataset growth |
| `improve-human-operator-output.md` | Agent narration during calibration: human words not machine codes, progress/ETA/trajectory, milestone summaries. | PoC completion |
| `defect-court.md` | Adversarial "Defect Court" phase (D0-D4): prosecution, defense, judicial verdict. | Architecture evolution |
| `workspace-revisited.md` | Universal artifact reference system: taxonomy, format learning, local catalog/cache. | Architecture evolution |
| `data-swipe.md` | Scrub internal infrastructure hostnames from entire git history. Pattern file in `.dev/` (gitignored). | Public repo hygiene |

_(Not yet written: persona-system -- specialized prompt preambles with workspace binding.)_

## completed/ -- Historical record (46 contracts)

Grouped by original development phase. All contracts below are **complete** (or closed).

### completed/mock/ (4)

| Contract | Goal |
|----------|------|
| `mock-pre-investigation.md` | Mock fetch + save envelope to store. |
| `mock-investigation.md` | Mock analyze: read from store, produce cases + artifact. |
| `mock-post-investigation.md` | Mock push: read artifact, write defect type + RCA. |
| `mock-wiring.md` | Wire fetch, analyze, push into one runnable flow. |

### completed/poc/ (11)

| Contract | Goal |
|----------|------|
| `rp-api-completion.md` | RP API research; document launch, test-item, defect-type. |
| `rp-api-research.md` | RP API deep research (5.11); endpoints, usage, example launch 33195. |
| `storage-adapter.md` | SQLite + Store facade (cases, RCAs); per-workspace DB. |
| `context-workspace.md` | Load workspace from FS (YAML/JSON); pass into analyze. |
| `artifact-schema.md` | Add `rca_message` to artifact; document schema. |
| `prompts.md` | Prompt templates in `.cursor/prompts/`; params doc. |
| `rp-fetch.md` | Real fetch from RP (launch by ID); produce envelope. |
| `rp-push.md` | Real push to RP (defect-type update from artifact). |
| `asterisk-cli.md` | `asterisk` binary with `analyze` and `push -f`. |
| `cursor-handoff.md` | Minimal `asterisk --cursor`; prompt output, save/ingest. |
| `pre-dev-questions.md` | Pre-development question bank; answers and deferrals. |

### completed/design/ (2)

| Contract | Goal |
|----------|------|
| `prompt-families.md` | Prompt family taxonomy (F0-F6), pipelines, loops, routing heuristics. |
| `investigation-context.md` | Two-tier data model: investigation tree + global knowledge. |

### completed/poc-v2/ (3)

| Contract | Goal |
|----------|------|
| `storage-adapter-v2.md` | Migrate Store to two-tier schema (execution tree + symptoms + RCAs). |
| `prompt-orchestrator.md` | F0-F6 pipeline engine: heuristics, artifact I/O, template filler, CLI. |
| `e2e-calibration.md` | Closed-world E2E test: 20 metrics, 3 scenarios, all stub-passing. |

### completed/pipeline/ (5)

| Contract | Goal |
|----------|------|
| `rp-adapter-v2.md` | Unified `internal/rp` package; scope-based client, APIError, context. |
| `fs-dispatcher.md` | Dispatcher interface; StdinDispatcher + FileDispatcher; `--dispatch` flag. |
| `cursor-skill.md` | `asterisk-investigate` Cursor skill; signal-based F0-F6 artifact production. |
| `wet-calibration.md` | Dry/wet calibration taxonomy, 28 Test Cards, victory loop. **Closed.** |
| `cleanup-lifecycle.md` | Automated pre-run cleanup, subprocess management, signal finalization. |

### completed/calibration/ (7)

| Contract | Goal |
|----------|------|
| `real-calibration-ingest.md` | Ingest real CI data into 30-case `ptp-real-ingest` scenario. |
| `calibration-bugfix-r5.md` | Fix 5 blocking bugs. M19: 0.58 to 0.65+. |
| `responder-classification-v2.md` | Scored multi-signal classifier. M19: 0.65 to 0.80+. |
| `calibration-victory.md` | Evidence quality, convergence calibration. M19: 0.80 to 0.95+. |
| `parallel-investigation.md` | Fan-out F0-F1, symptom clustering, 3x speedup. |
| `ground-truth-v2.md` | Correct scenario data to match Jira audit. |
| `true-wet-calibration.md` | Blind calibration against Jira-verified truth. M19 = 0.93 achieved. |

### completed/multi-subagent/ (4)

| Contract | Goal |
|----------|------|
| `batch-dispatch-protocol.md` | Batch signal protocol: manifest, briefing, concurrent semantics. |
| `batch-file-dispatcher.md` | Go implementation: `BatchFileDispatcher`, `ManifestWriter`, `--dispatch=batch-file`. |
| `multi-subagent-skill.md` | Parent-child skill: Task subagent spawning (up to 4), batch lifecycle. |
| `adaptive-subagent-scheduler.md` | Quality-driven batch sizing, token budget enforcement, cost model. |

### completed/architecture/ (4)

| Contract | Goal |
|----------|------|
| `calibrate-decomposition.md` | Split `calibrate` into `dispatch/`, `adapt/` sub-packages. |
| `cobra-cli.md` | Cobra CLI migration; subcommands, help, shell completion. |
| `critical-test-coverage.md` | Close 8 test gaps; 80%+ critical, 70%+ high, 60%+ medium. |
| `concurrency-modernization.md` | errgroup + context.Context propagation; eliminate mutable globals. |

### completed/output/ (6)

| Contract | Goal |
|----------|------|
| `human-readable-output.md` | Replace machine codes with human-readable names; `internal/display` registry. |
| `unified-formatter.md` | `go-pretty/v6` adapter; `internal/format` with ASCII + Markdown modes. |
| `token-perf-tracking.md` | Instrument real token usage; compute cost; upgrade M18. |
| `tokimeter.md` | Markdown-formatted cost bill per case/step/total. |
| `transcript-weaver.md` | Post-hoc Markdown transcript per Root Cause; flag-gated, adapter-agnostic. |
| `go-testing-preferences.md` | Go testing: stdlib vs Ginkgo; rules in `rules/go-test-conventions.mdc`. |

---

## Directories

- `active/` -- Contracts currently being executed.
- `draft/` -- Planned contracts not yet being executed.
- `completed/` -- Finished contracts grouped by original development phase.

## Files (root)

- `index.mdc` -- This file.
- `current-goal.mdc` -- Goal manifest: declares active goal and urgency map for all non-completed contracts.
- `_TEMPLATE.md` -- Contract template; copy to create new contracts.
