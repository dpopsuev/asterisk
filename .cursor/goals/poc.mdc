---
description: PoC goal statement and success criteria
---

# PoC — CLI + MCP

## CRISIS: Agentic flow broken

The file-based signal protocol (`signal.json` / `FileDispatcher`) is a dead end. Every artifact write requires Cursor user-approval, making the cursor adapter calibration loop (18 cases x ~5 steps = ~90 approvals) unusable in practice. The PoC cannot validate AI-driven RCA without a working agentic flow.

**Decision:** Pull MCP into the PoC scope. Implement the thinnest viable `asterisk serve` MCP server so the Cursor agent can drive calibration via tool calls with zero approval gates. This is no longer post-PoC — it is the PoC.

## Goal statement

Asterisk PoC is a **Go CLI + MCP server** that proves real-world RCA capability:
1. **BasicAdapter (heuristic):** fetch live RP data, score against Jira-verified ground truth. **Done.**
2. **CursorAdapter (AI via MCP):** Cursor agent drives investigation via MCP tool calls, scores against same ground truth. **Blocked on MCP.**
3. **Push verified** results to RP after cursor adapter demonstrates genuine reasoning.

## Scope (in)

- **CLI commands:** `analyze`, `calibrate`, `push`, **`serve`**. Cobra-based.
- **`serve`** — Starts an MCP server over stdio. Cursor calls tools directly. Replaces file-based signal protocol for cursor adapter.
- **`calibrate`** — Unchanged. Runs pipeline against scenario, computes M1-M20+M14b. Works with `--adapter=basic` (CLI) and `--adapter=cursor` (via MCP).
- **`analyze`** — Single-launch RCA. Output: artifact on FS.
- **`push`** — Push artifact to RP. Explicit; no auto-push.
- **Adapters:** `StubAdapter`, `BasicAdapter`, `CursorAdapter`.
- **Dispatchers:** `StdinDispatcher`, `FileDispatcher`, **`MCPDispatcher`** (channel bridge to MCP tools).
- **Scenarios:** `ptp-mock`, `daemon-mock`, `ptp-real`, `ptp-real-ingest` (30 cases, 20 RP-sourced).
- **Metrics:** M1-M20+M14b. Ground truth: 18 grade-A cases with FixPRs, SmokingGun, EvidenceGrade.
- **MCP tools (minimum):** `start_calibration`, `get_next_step`, `submit_artifact`, `get_report`.

## Out of scope (for PoC)

- Standalone service (MVP).
- Adversarial RCA / Defect Court (future).
- Universal artifact workspace (future).
- Persona system (future).
- Full MCP tool suite (analyze, push via MCP — post-PoC).

## Success criteria

1. **CLI complete:** ✅ `analyze`, `calibrate`, `push -f` implemented; artifact format stable.
2. **Real blind E2E (BasicAdapter):** ✅ 20 RP-sourced cases processed. Post-tightening baselines: M19=0.88 (all 30), M19=0.83 (grade-A 18). M14b=0.13 (smoking gun baseline). _(Contract: `rp-e2e-launch`, Phases 1-3)_
3. **MCP server operational:** `asterisk serve` starts, Cursor connects via `.cursor/mcp.json`, `start_calibration` + `get_next_step` + `submit_artifact` + `get_report` tools work end-to-end. _(Plan: `mcp_calibration_integration`)_
4. **Cursor adapter baseline (via MCP):** Grade-A blind test (18 cases) completes via MCP tool loop. M19 >= 0.85, M12 >= 0.50, M14b >= 0.40. Head-to-head comparison with BasicAdapter documented. _(Contract: `rp-e2e-launch`, Phase 5a)_
5. **Push verified:** Push best-quality artifact to RP after cursor adapter demonstrates genuine reasoning. _(Contract: `rp-e2e-launch`, Phase 6)_
6. **No regression:** BasicAdapter calibration unchanged by MCP addition.

## What is done

| Item | Status | Result |
|------|--------|--------|
| CLI commands | Done | analyze, calibrate, push, cursor, save, status |
| BasicAdapter E2E (all 30) | Done | M19=0.88, 18/21 pass |
| BasicAdapter E2E (grade-A 18) | Done | M19=0.83, 19/21 pass, M14b=0.13 |
| Ground truth tightening | Done | 18 grade-A cases with FixPRs, SmokingGun, EvidenceGrade |
| Signal protocol mechanical test | Done | 1 case through all 6 pipeline steps via FileDispatcher |
| Evidence gap brief | Done | BasicAdapter limitations documented |

## What is blocked

| Item | Blocker | Resolution |
|------|---------|------------|
| Cursor adapter calibration | FileDispatcher requires Cursor approval per artifact write (~90 clicks) | Implement MCP server |
| Push to RP | No cursor adapter results yet | Depends on MCP |
| Head-to-head comparison | No cursor adapter results yet | Depends on MCP |

## Next steps (in order)

1. **Implement MCP server** — thinnest viable `asterisk serve` with 4 tools. Channel bridge to existing runner. No refactoring of calibration logic.
2. **Run Phase 5a via MCP** — 18 grade-A cases, cursor adapter, score against ground truth.
3. **Head-to-head comparison** — fill comparison table, document findings.
4. **Push to RP** — best-quality artifact after confidence gained.
5. **Embed prompts in binary (`go:embed`)** — In production the binary ships alone with no workspace. Move `.cursor/prompts/` into the Go module tree (e.g. `internal/prompts/templates/`), embed via `go:embed`, keep `--prompt-dir` as override for local tuning.
6. **Document and close PoC.**
