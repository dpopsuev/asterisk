---
description: Asterisk development style from roadmap
alwaysApply: true
---

# Asterisk Development Style

## Product intent
- Asterisk is a **standalone CLI** (possibly a side-car service), **written in Go**, interacting with ReportPortal via the **RP API** (client, not an RP plugin).
- Asterisk exists to perform RCA on Report Portal failures by correlating with external repos and CI/infra data.
- Prefer explainable evidence-first RCA with confidence scores.

## Development methodology (BDD + TDD + AI)
- Start every story by writing Gherkin acceptance criteria (Given/When/Then).
- Create a test matrix for unit, integration, contract, e2e, and security tests.
- Implement in small increments; each increment must keep tests green.
- Prefer deterministic outputs for the same inputs; seed ordering where needed.
- Every AI inference must cite evidence (logs, commits, pipeline data).

## Scope alignment
- Focus on the current PoC goal; defer future phases unless re-scoped.

## Calibration ordering
- **Mock calibration** (synthetic ground truth) runs throughout development and guides refactoring.
- **Real calibration** (actual Jira bugs, RP launches, production repos) is the **absolute last step** â€” a final tuning pass. It must not be attempted until:
  1. All implementation contracts are complete (storage-adapter-v2, prompt-orchestrator, etc.).
  2. The codebase has been refactored and decoupled to a clean, testable state.
  3. Mock calibration consistently passes its acceptance thresholds.
- Rationale: real data calibration validates the finished system; running it on messy, mid-refactor code produces misleading metrics and wastes real-data setup effort.

## Persistence
- Use the **storage adapter** interface only for cases, RCAs, and pipeline hierarchy; no raw SQLite in domain or CLI code. See `docs/cli-data-model.mdc`.

## Data and security
- Treat external data (RP, CI, repos) as partial and potentially missing; return partial results with clear errors.
- Redact secrets/PII in all outputs by default.
- All external calls must have timeouts and retry with backoff.

## Output standards
- Provide RCA summary, suspected components/commits, category + confidence, and next actions.
- Include evidence links for every conclusion.

## Cursor knowledge management
- Follow `.cursor/meta.mdc` as the binding structure contract.
