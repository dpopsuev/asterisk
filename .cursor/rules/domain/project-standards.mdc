---
description: Asterisk project standards — product intent, development methodology, data handling, and output requirements
alwaysApply: true
---

# Project Standards

## Product definition

- Asterisk is a **standalone Go CLI** (potential sidecar service) that interacts with ReportPortal via the RP API as an external client.
- Purpose: automated root-cause analysis on RP test failures by correlating with source repositories, CI pipelines, and infrastructure telemetry.
- Design principle: explainable, evidence-first RCA with confidence scores.

## Development methodology

- Start every story with Gherkin acceptance criteria (Given / When / Then).
- Follow the **Red-Orange-Green-Yellow-Blue** cycle (see `rules/testing-methodology.mdc`).
- Run the local pipeline after every change (see `rules/agent-operations.mdc`).
- Prefer deterministic outputs for identical inputs; seed ordering where needed.
- Every AI inference must cite evidence (logs, commits, pipeline data).

## Safety > Speed

> **Safety comes at the cost of speed, and speed at the cost of safety.**

End-users will not use tools whose accuracy is low. Speed (still faster than a human) and cost (human wages >> agent tokens) are negligible second-order priorities. All metric thresholds, weights, and design decisions optimize for **outcome correctness first**. Efficiency metrics exist as health checks, not quality gates.

- At 50,000x ROI ($1 AI cost saves $50K labor), token budget is irrelevant. A correct answer at $0.25 beats a wrong answer at $0.05.
- Outcome metrics (M1, M15, M10) are weighted highest. Efficiency metrics (M16, M17, M18) are health checks.
- When accuracy and speed conflict, accuracy wins unconditionally.

## Scope alignment

- Focus on the current goal. Defer future phases unless explicitly re-scoped.

## API stability (Origami dependency)

> **Applies only while PoC is the current goal.** When the "PoC Done" flag is raised (see `goals/`), flip this section to require coordinated migration windows for Origami API changes. See Origami's `goals/poc-done-flips.md` for the full checklist.

- **Origami breaking changes are expected.** Asterisk is the sole consumer. When Origami removes or renames an API, update Asterisk immediately — do not maintain shims or backward-compat wrappers.
- **Delete over deprecate.** If Origami deletes a package (e.g., `workspace/` → `knowledge/`), remove all references in the same session. No `// Deprecated:` markers survive.

## Calibration ordering

Three modes form a progression (see `glossary/glossary.mdc` for definitions):

1. **Stub** — deterministic, no LLM. Validates pipeline machinery. Runs after every code change.
2. **Dry** (real LLM + synthetic data) — validates prompts and model behavior. Runs continuously during tuning. Evidence metrics (M12/M13) are structurally capped because workers cannot access real repos.
3. **Wet** (real LLM + production data) — the **final step**, attempted only when:
   - All implementation contracts are complete.
   - The codebase is refactored and testable.
   - Dry calibration consistently passes acceptance thresholds.
4. Rationale: wet calibration validates the finished system. Running it on mid-refactor code produces misleading metrics.

## Data handling

- Treat external data (RP, CI, repos) as partial and potentially absent. Return partial results with clear errors.
- Redact secrets and PII in all outputs by default.
- All external calls require timeouts and retry with exponential backoff (see `rules/agent-operations.mdc`).
- **RP auto-analyzed classifications are low-accuracy data.** When `autoAnalyzed=true` on an RP issue, the defect type was set by RP's built-in ML — not by a human. These classifications must never be used as ground truth, metric baselines, or accuracy benchmarks. Only evidence-backed human assessment is authoritative. Asterisk surfaces this flag as `[auto]` in output so readers can gauge trust.

## Persistence

- Use the **storage adapter** interface for cases, RCAs, and pipeline hierarchy. No raw SQLite in domain or CLI code.

## Output requirements

- RCA output must include: summary, suspected components/commits, category + confidence, and recommended next actions.
- Every conclusion must link to supporting evidence.

## Company alignment

Asterisk is a Red Hat tool serving Red Hat's telco quality engineering mission. See `strategy/red-hat-telco-soul.mdc` for the full identity.

- **Identity**: Red Hat — the world's largest open source company. Upstream-first, community-driven, open by default.
- **Domain**: telco QE on OpenShift. Current use case: PTP Operator CI. Target: N operators across RAN, Core, edge, and platform.
- **Philosophy**: evidence over authority, community over control, meritocracy of ideas. No black-box conclusions.
- **Scale**: design for multi-team, multi-operator, multi-CI from the start. Operator-specific and CI-specific logic belongs in adapters, not in the core. See `strategy/rca-invariants.mdc` for company-aligned invariants.
