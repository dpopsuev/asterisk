{
  "name": "ptp-mock",
  "description": "PTP Calibration World: synthetic ground truth with 12 cases, 4 symptoms, 3 RCAs across 3 versions",
  "rcas": [
    {
      "id": "R1",
      "title": "Holdover timeout reduced from 300s to 60s in operator 4.21.0-202602070620",
      "description": "The holdover timeout was changed from 300 seconds to 60 seconds in linuxptp-daemon config, causing PTP sync to fail prematurely under normal clock recovery scenarios.",
      "defect_type": "pb001",
      "category": "product",
      "component": "linuxptp-daemon",
      "affected_versions": [
        "4.20",
        "4.21",
        "4.22"
      ],
      "jira_id": "OCPBUGS-1001",
      "required_keywords": [
        "holdover",
        "timeout",
        "60",
        "300",
        "linuxptp",
        "FREERUN"
      ],
      "keyword_threshold": 3,
      "relevant_repos": [
        "linuxptp-daemon-operator"
      ],
      "verified": false
    },
    {
      "id": "R2",
      "title": "Test cleanup missing: PTP config CRD not deleted between test suites",
      "description": "The AfterSuite cleanup in ptp_config_test.go was commented out, leaving stale PtpConfig CRDs that cause assertion failures in subsequent tests.",
      "defect_type": "au001",
      "category": "automation",
      "component": "ptp-test-framework",
      "affected_versions": [
        "4.21"
      ],
      "jira_id": "OCPBUGS-1002",
      "required_keywords": [
        "cleanup",
        "CRD",
        "AfterSuite",
        "isolation",
        "ptp-config"
      ],
      "keyword_threshold": 2,
      "relevant_repos": [
        "ptp-test-framework"
      ],
      "verified": false
    },
    {
      "id": "R3",
      "title": "NTP server unreachable from test cluster node (infra flap)",
      "description": "The NTP server configured in chrony.conf became unreachable from the test cluster, causing chronyd to lose all selectable sources. Infrastructure issue, not a code bug.",
      "defect_type": "en001",
      "category": "environment",
      "component": "cluster-infra",
      "affected_versions": [
        "4.21"
      ],
      "required_keywords": [
        "NTP",
        "unreachable",
        "chronyd",
        "infra"
      ],
      "keyword_threshold": 2,
      "relevant_repos": [
        "cluster-infra-config"
      ],
      "verified": false
    }
  ],
  "symptoms": [
    {
      "id": "S1",
      "name": "ptp4l sync timeout",
      "error_pattern": "ptp4l.*FREERUN.*holdover exceeded",
      "component": "linuxptp-daemon",
      "maps_to_rca": "R1"
    },
    {
      "id": "S2",
      "name": "Stale PTP config CRD assertion",
      "error_pattern": "Expected PtpConfig.*not to exist.*but it does",
      "component": "ptp-test-framework",
      "maps_to_rca": "R2"
    },
    {
      "id": "S3",
      "name": "NTP sync loss",
      "error_pattern": "chronyd.*no selectable sources",
      "component": "cluster-infra",
      "maps_to_rca": "R3"
    },
    {
      "id": "S4",
      "name": "ptp4l recovery failure",
      "error_pattern": "ptp4l.*failed to recover lock within.*seconds",
      "component": "linuxptp-daemon",
      "maps_to_rca": "R1"
    }
  ],
  "cases": [
    {
      "id": "C1",
      "version": "4.20",
      "job": "[T-TSC]",
      "test_name": "OCP-83297 PTP sync stability",
      "error_message": "ptp4l[12345.678]: port 1: FREERUN state, holdover exceeded after 60s (expected 300s)",
      "log_snippet": "2026-02-01T10:00:00Z ptp4l[12345.678]: port 1: FREERUN state, holdover exceeded after 60s\n2026-02-01T10:00:01Z ptp4l[12345.678]: timed out waiting for clock recovery\nFAIL: Expected clock state to be LOCKED within 300s timeout",
      "symptom_id": "S1",
      "rca_id": "R1",
      "expected_path": [
        "F0",
        "F1",
        "F2",
        "F3",
        "F4",
        "F5",
        "F6"
      ],
      "expected_recall": {
        "match": false,
        "confidence": 0
      },
      "expected_triage": {
        "symptom_category": "product",
        "severity": "critical",
        "defect_type_hypothesis": "pb001",
        "candidate_repos": [
          "linuxptp-daemon-operator",
          "cluster-infra-config"
        ],
        "skip_investigation": false,
        "cascade_suspected": false
      },
      "expected_resolve": {
        "selected_repos": [
          {
            "name": "linuxptp-daemon-operator",
            "reason": "Product code with holdover config"
          }
        ]
      },
      "expected_invest": {
        "rca_message": "Holdover timeout reduced from 300s to 60s in linuxptp-daemon config (commit abc1234 on release-4.21). The ptp4l process enters FREERUN state and cannot recover because the holdover period is too short.",
        "defect_type": "pb001",
        "component": "linuxptp-daemon",
        "convergence_score": 0.85,
        "evidence_refs": [
          "linuxptp-daemon-operator:pkg/daemon/config.go:abc1234"
        ]
      },
      "expected_correlate": {
        "is_duplicate": false,
        "confidence": 0.3,
        "cross_version_match": false
      },
      "expected_review": {
        "decision": "approve"
      },
      "expect_recall_hit": false,
      "expect_skip": false,
      "expect_cascade": false,
      "expected_loops": 0
    },
    {
      "id": "C2",
      "version": "4.20",
      "job": "[T-BC]",
      "test_name": "OCP-83297 PTP sync stability",
      "error_message": "ptp4l[23456.789]: port 1: FREERUN state, holdover exceeded after 60s (expected 300s)",
      "log_snippet": "2026-02-01T11:30:00Z ptp4l[23456.789]: port 1: FREERUN state, holdover exceeded after 60s\nFAIL: Expected clock state to be LOCKED within 300s timeout",
      "symptom_id": "S1",
      "rca_id": "R1",
      "expected_path": [
        "F0",
        "F5",
        "F6"
      ],
      "expected_recall": {
        "match": true,
        "confidence": 0.95
      },
      "expected_review": {
        "decision": "approve"
      },
      "expect_recall_hit": true,
      "expect_skip": false,
      "expect_cascade": false,
      "expected_loops": 0
    },
    {
      "id": "C3",
      "version": "4.21",
      "job": "[T-TSC]",
      "test_name": "OCP-83297 PTP sync stability",
      "error_message": "ptp4l[34567.890]: port 1: FREERUN state, holdover exceeded after 60s (expected 300s)",
      "log_snippet": "2026-02-05T08:15:00Z ptp4l[34567.890]: port 1: FREERUN state, holdover exceeded after 60s\nFAIL: Expected clock state to be LOCKED within 300s timeout",
      "symptom_id": "S1",
      "rca_id": "R1",
      "expected_path": [
        "F0",
        "F5",
        "F6"
      ],
      "expected_recall": {
        "match": true,
        "confidence": 0.95
      },
      "expected_review": {
        "decision": "approve"
      },
      "expect_recall_hit": true,
      "expect_skip": false,
      "expect_cascade": false,
      "expected_loops": 0
    },
    {
      "id": "C4",
      "version": "4.21",
      "job": "[T-TSC]",
      "test_name": "OCP-83299 PTP config isolation",
      "error_message": "Expected PtpConfig 'test-ptp-config' not to exist in namespace 'openshift-ptp' but it does",
      "log_snippet": "2026-02-05T09:00:00Z STEP: Verifying PTP config isolation\n2026-02-05T09:00:01Z Expected PtpConfig 'test-ptp-config' not to exist in namespace 'openshift-ptp' but it does\nFAIL: Stale PTP config CRD found from previous test suite",
      "symptom_id": "S2",
      "rca_id": "R2",
      "expected_path": [
        "F0",
        "F1",
        "F3",
        "F4",
        "F5",
        "F6"
      ],
      "expected_recall": {
        "match": false,
        "confidence": 0
      },
      "expected_triage": {
        "symptom_category": "automation",
        "severity": "high",
        "defect_type_hypothesis": "au001",
        "candidate_repos": [
          "ptp-test-framework"
        ],
        "skip_investigation": false,
        "cascade_suspected": false
      },
      "expected_resolve": {
        "selected_repos": [
          {
            "name": "ptp-test-framework",
            "reason": "Test code with missing cleanup"
          }
        ]
      },
      "expected_invest": {
        "rca_message": "AfterSuite cleanup in ptp_config_test.go is commented out. Stale PtpConfig CRDs from previous test suites are not deleted, causing assertion failures when the next suite checks for config isolation.",
        "defect_type": "au001",
        "component": "ptp-test-framework",
        "convergence_score": 0.9,
        "evidence_refs": [
          "ptp-test-framework:test/e2e/ptp_config_test.go:AfterSuite"
        ]
      },
      "expected_correlate": {
        "is_duplicate": false,
        "confidence": 0.3,
        "cross_version_match": false
      },
      "expected_review": {
        "decision": "approve"
      },
      "expect_recall_hit": false,
      "expect_skip": false,
      "expect_cascade": false,
      "expected_loops": 0
    },
    {
      "id": "C5",
      "version": "4.21",
      "job": "[T-TSC]",
      "test_name": "OCP-83300 PTP config cleanup",
      "error_message": "Expected PtpConfig 'cleanup-config' not to exist in namespace 'openshift-ptp' but it does",
      "log_snippet": "2026-02-05T09:30:00Z Expected PtpConfig 'cleanup-config' not to exist\nFAIL: CRD cleanup failure",
      "symptom_id": "S2",
      "rca_id": "R2",
      "expected_path": [
        "F0",
        "F5",
        "F6"
      ],
      "expected_recall": {
        "match": true,
        "confidence": 0.92
      },
      "expected_review": {
        "decision": "approve"
      },
      "expect_recall_hit": true,
      "expect_skip": false,
      "expect_cascade": false,
      "expected_loops": 0
    },
    {
      "id": "C6",
      "version": "4.21",
      "job": "[T-BC]",
      "test_name": "OCP-83297 PTP sync stability",
      "error_message": "ptp4l[45678.901]: port 1: FREERUN state, holdover exceeded after 60s (expected 300s)",
      "log_snippet": "2026-02-05T11:00:00Z ptp4l[45678.901]: port 1: FREERUN state, holdover exceeded after 60s\nFAIL: Expected clock state to be LOCKED",
      "symptom_id": "S1",
      "rca_id": "R1",
      "expected_path": [
        "F0",
        "F5",
        "F6"
      ],
      "expected_recall": {
        "match": true,
        "confidence": 0.95
      },
      "expected_review": {
        "decision": "approve"
      },
      "expect_recall_hit": true,
      "expect_skip": false,
      "expect_cascade": false,
      "expected_loops": 0
    },
    {
      "id": "C7",
      "version": "4.21",
      "job": "[T-BC]",
      "test_name": "OCP-83300 PTP config cleanup",
      "error_message": "Expected PtpConfig 'bc-test-config' not to exist in namespace 'openshift-ptp' but it does",
      "log_snippet": "2026-02-05T11:30:00Z Expected PtpConfig 'bc-test-config' not to exist\nFAIL: Stale CRD",
      "symptom_id": "S2",
      "rca_id": "R2",
      "expected_path": [
        "F0",
        "F5",
        "F6"
      ],
      "expected_recall": {
        "match": true,
        "confidence": 0.92
      },
      "expected_review": {
        "decision": "approve"
      },
      "expect_recall_hit": true,
      "expect_skip": false,
      "expect_cascade": false,
      "expected_loops": 0
    },
    {
      "id": "C8",
      "version": "4.21",
      "job": "[BC-OC]",
      "test_name": "OCP-49734 NTP sync validation",
      "error_message": "chronyd[5678]: no selectable sources — all NTP servers unreachable",
      "log_snippet": "2026-02-05T12:00:00Z chronyd[5678]: no selectable sources\n2026-02-05T12:00:01Z chronyd[5678]: can't synchronise: no NTP server reachable\nFAIL: Expected NTP sync within 60s",
      "symptom_id": "S3",
      "rca_id": "R3",
      "expected_path": [
        "F0",
        "F1",
        "F5",
        "F6"
      ],
      "expected_recall": {
        "match": false,
        "confidence": 0
      },
      "expected_triage": {
        "symptom_category": "infra",
        "severity": "medium",
        "defect_type_hypothesis": "en001",
        "candidate_repos": null,
        "skip_investigation": true,
        "cascade_suspected": false
      },
      "expected_review": {
        "decision": "approve"
      },
      "expect_recall_hit": false,
      "expect_skip": true,
      "expect_cascade": false,
      "expected_loops": 0
    },
    {
      "id": "C9",
      "version": "4.22",
      "job": "[T-TSC]",
      "test_name": "OCP-83297 PTP sync stability",
      "error_message": "ptp4l[56789.012]: port 1: FREERUN state, holdover exceeded after 60s (expected 300s)",
      "log_snippet": "2026-02-10T08:00:00Z ptp4l[56789.012]: port 1: FREERUN state, holdover exceeded after 60s\nFAIL: Expected clock state to be LOCKED",
      "symptom_id": "S1",
      "rca_id": "R1",
      "expected_path": [
        "F0",
        "F5",
        "F6"
      ],
      "expected_recall": {
        "match": true,
        "confidence": 0.95
      },
      "expected_review": {
        "decision": "approve"
      },
      "expect_recall_hit": true,
      "expect_skip": false,
      "expect_cascade": false,
      "expected_loops": 0
    },
    {
      "id": "C10",
      "version": "4.22",
      "job": "[T-TSC]",
      "test_name": "OCP-83302 PTP recovery test",
      "error_message": "ptp4l[67890.123]: failed to recover lock within 120 seconds after holdover",
      "log_snippet": "2026-02-10T09:00:00Z ptp4l[67890.123]: failed to recover lock within 120 seconds\n2026-02-10T09:02:00Z ptp4l[67890.123]: recovery timeout, staying in FREERUN\nFAIL: PTP lock recovery failed",
      "symptom_id": "S4",
      "rca_id": "R1",
      "expected_path": [
        "F0",
        "F1",
        "F3",
        "F4"
      ],
      "expected_recall": {
        "match": false,
        "confidence": 0.1
      },
      "expected_triage": {
        "symptom_category": "product",
        "severity": "critical",
        "defect_type_hypothesis": "pb001",
        "candidate_repos": [
          "linuxptp-daemon-operator"
        ],
        "skip_investigation": false,
        "cascade_suspected": false
      },
      "expected_resolve": {
        "selected_repos": [
          {
            "name": "linuxptp-daemon-operator",
            "reason": "Product code with holdover config"
          }
        ]
      },
      "expected_invest": {
        "rca_message": "PTP lock recovery fails because the holdover timeout was reduced from 300s to 60s. The ptp4l process enters FREERUN after 60s and never recovers. Same root cause as the sync stability failures — commit abc1234 on release-4.21.",
        "defect_type": "pb001",
        "component": "linuxptp-daemon",
        "convergence_score": 0.8,
        "evidence_refs": [
          "linuxptp-daemon-operator:pkg/daemon/config.go:abc1234"
        ]
      },
      "expected_correlate": {
        "is_duplicate": true,
        "confidence": 0.88,
        "cross_version_match": true
      },
      "expected_review": {
        "decision": "approve"
      },
      "expect_recall_hit": false,
      "expect_skip": false,
      "expect_cascade": false,
      "expected_loops": 0
    },
    {
      "id": "C11",
      "version": "4.21",
      "job": "[T-TSC]",
      "test_name": "OCP-83303 PTP flaky timing",
      "error_message": "Timed out after 10.000s: Expected PTP offset to stabilize within 10s (intermittent)",
      "log_snippet": "2026-02-05T14:00:00Z ptp4l: offset +1234567ns, s2 LOCKED\n2026-02-05T14:00:05Z ptp4l: offset -987654ns, s2 LOCKED\nFAIL: Timed out after 10.000s",
      "symptom_id": "",
      "rca_id": "",
      "expected_path": [
        "F0",
        "F1",
        "F5",
        "F6"
      ],
      "expected_recall": {
        "match": false,
        "confidence": 0
      },
      "expected_triage": {
        "symptom_category": "flake",
        "severity": "low",
        "defect_type_hypothesis": "nd001",
        "candidate_repos": null,
        "skip_investigation": true,
        "cascade_suspected": false
      },
      "expected_review": {
        "decision": "approve"
      },
      "expect_recall_hit": false,
      "expect_skip": true,
      "expect_cascade": false,
      "expected_loops": 0
    },
    {
      "id": "C12",
      "version": "4.21",
      "job": "[T-TSC]",
      "test_name": "OCP-83304 PTP ordered setup",
      "error_message": "Expected PtpConfig 'ordered-setup' not to exist in namespace 'openshift-ptp' but it does [cascade from OCP-83299]",
      "log_snippet": "2026-02-05T15:00:00Z BeforeSuite: checking PTP config state\n2026-02-05T15:00:01Z Expected PtpConfig 'ordered-setup' not to exist\nFAIL: Cascade failure from stale CRD (related to OCP-83299)",
      "symptom_id": "S2",
      "rca_id": "R2",
      "expected_path": [
        "F0",
        "F1",
        "F3",
        "F4"
      ],
      "expected_recall": {
        "match": false,
        "confidence": 0.15
      },
      "expected_triage": {
        "symptom_category": "automation",
        "severity": "high",
        "defect_type_hypothesis": "au001",
        "candidate_repos": [
          "ptp-test-framework"
        ],
        "skip_investigation": false,
        "cascade_suspected": true
      },
      "expected_resolve": {
        "selected_repos": [
          {
            "name": "ptp-test-framework",
            "reason": "Test code with missing cleanup"
          }
        ]
      },
      "expected_invest": {
        "rca_message": "Cascade from stale PtpConfig CRD. Same root cause as OCP-83299 — AfterSuite cleanup missing.",
        "defect_type": "au001",
        "component": "ptp-test-framework",
        "convergence_score": 0.85,
        "evidence_refs": [
          "ptp-test-framework:test/e2e/ptp_config_test.go:AfterSuite"
        ]
      },
      "expected_correlate": {
        "is_duplicate": true,
        "confidence": 0.9,
        "cross_version_match": false
      },
      "expected_review": {
        "decision": "approve"
      },
      "expect_recall_hit": false,
      "expect_skip": false,
      "expect_cascade": true,
      "expected_loops": 0
    }
  ],
  "workspace": {
    "repos": [
      {
        "name": "linuxptp-daemon-operator",
        "path": "",
        "purpose": "PTP operator: manages linuxptp-daemon DaemonSet, PtpConfig CRD, clock sync",
        "branch": "release-4.21",
        "relevant_to_rcas": [
          "R1"
        ]
      },
      {
        "name": "ptp-test-framework",
        "path": "",
        "purpose": "E2E test suite for PTP operator: Ginkgo specs, test helpers, fixtures",
        "branch": "main",
        "relevant_to_rcas": [
          "R2"
        ]
      },
      {
        "name": "cluster-infra-config",
        "path": "",
        "purpose": "CI cluster configuration: job profiles, NTP config, network templates",
        "branch": "main",
        "relevant_to_rcas": [
          "R3"
        ]
      },
      {
        "name": "sriov-network-operator",
        "path": "",
        "purpose": "SR-IOV network operator: VF allocation, device plugin (NOT PTP-related)",
        "branch": "release-4.21",
        "is_red_herring": true
      },
      {
        "name": "cnf-features-deploy",
        "path": "",
        "purpose": "CNF deployment manifests and CI profiles: contains job definitions for all telco operators",
        "branch": "master"
      }
    ]
  },
  "dry_capped_metrics": [
    "M12",
    "M13"
  ]
}