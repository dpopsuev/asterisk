# D0-D4 Defect Court adversarial pipeline.
# Shadow path activates when Light F5 confidence is in the uncertain range.
# Edge evaluation logic is registered via BuildCourtEdgeFactory in Go.
pipeline: defect-court
description: "D0-D4 adversarial review pipeline"

zones:
  prosecution:
    nodes: [indict]
    element: fire
    stickiness: 0
  discovery:
    nodes: [discover, defend]
    element: water
    stickiness: 2
  bench:
    nodes: [hearing, verdict]
    element: diamond
    stickiness: 3

nodes:
  - name: indict
    element: fire
    family: indict
  - name: discover
    element: earth
    family: discover
  - name: defend
    element: water
    family: defend
  - name: hearing
    element: air
    family: hearing
  - name: verdict
    element: diamond
    family: verdict

edges:
  - id: HD1
    name: fast-track
    from: indict
    to: defend
    shortcut: true
    condition: "prosecution confidence >= 0.95"

  - id: HD2
    name: plea-deal
    from: defend
    to: verdict
    shortcut: true
    condition: "defense concedes"

  - id: HD3
    name: motion-to-dismiss
    from: defend
    to: hearing
    condition: "defense has motion to dismiss"

  - id: HD4
    name: alternative-hypothesis
    from: defend
    to: hearing
    condition: "defense has alternative hypothesis"

  - id: HD5
    name: hearing-complete
    from: hearing
    to: verdict
    condition: "max rounds reached OR convergence"

  - id: HD6
    name: affirm
    from: verdict
    to: _done
    condition: "verdict == affirm"

  - id: HD7
    name: amend
    from: verdict
    to: _done
    condition: "verdict == amend"

  - id: HD8
    name: remand
    from: verdict
    to: indict
    loop: true
    condition: "verdict == remand AND remands < max_remands"

  - id: HD9
    name: acquit
    from: verdict
    to: _done
    condition: "verdict == acquit (evidence gap brief)"

  - id: HD12
    name: judge-mistrial
    from: verdict
    to: _done
    condition: "verdict == mistrial"

start: indict
done: _done
